<!DOCTYPE html>
<html>
  <%- include("./partials/head.ejs", {title: "Insertion"}) %>
  <body>

    <div id="insertion-wrapper">
      <%- include("./partials/nav.ejs") %>
      <div id="back-btn" class="btn btn-primary">&#8617; Indietro</div>
      <div id="insertion-content">
        <div id="left">
          <div id="insertion-heading">
            <h1></h1>
          </div>
          <div id="showcase">
            <div id="carousel-container">
              <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                  <div class="carousel-item active">
                    <img class="d-block w-100" src="" alt="First slide">
                  </div>
                  <div class="carousel-item">
                    <img class="d-block w-100" src="" alt="Second slide">
                  </div>
                  <div class="carousel-item">
                    <img class="d-block w-100" src="" alt="Third slide">
                  </div>
                </div>
                <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                  <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                  <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                  <span class="carousel-control-next-icon" aria-hidden="true"></span>
                  <span class="sr-only">Next</span>
                </a>
              </div>
            </div>
            <div id="description">
              <div id="typografy">
                <div id="citta">
                  <h3></h3>
                </div>
                <div id="desc">
                  <p></p>
                </div>
                <div id="desc-rooms">
                  <p></p>
                </div>
              </div>
              <div id="map">
                <iframe  
                  width="100%"
                  height="100%"
                  frameborder="0" style="border:0"
                  src="" allowfullscreen>
                </iframe>
              </div>
            </div>
          </div>
          <div>asdasdasda</div>
        </div>
        <div id="right">
          asdasd
        </div>
      </div>
      <div id="footer"><%- include("./partials/footer.ejs") %></div>
    </div>

    <script>
      $("document").ready(function (e) {
        
        // Back button
        // Uso go(-2) e non back() perché devo andare indietro di
        // due posizioni per tornare alla pagina di ricerca.
        // Questo è causato dal fatto che prima io apro una pagina
        // con le informazioni del db. Poi viene fatta una fetch
        // ai server google per ottenere la minimappa che ricarica la pagina.
        // Quindi andando indietro di 1 pagina oscurerei solo la mappa,
        // senza tornare indietro.
        $("#back-btn").on("click", () => {
          window.history.go(-2);
        });

        // Fetch insertion information
        let inserzione;

        fetch(`/inserzione/res${window.location.search}`)
          .then(async (res) => {
            const response = await res.json();
            inserzione = response.show;
            // Inserisco tutte le informazioni nei vari campi
            // Heading
            $("#insertion-heading > h1").append(response.show.nome_inserzione);
            // Showcase
            // -- Carousel
            $(".carousel-item > img").each((index, element) => {
              $(element).attr("src", `${response.show.galleryPath}homePage${index + 1}.jpg`)
            });
            // -- Description
            $("#citta > h3").append(response.show.citta);
            $("#desc > p").append(response.show.descrizione);
            $("#desc-rooms > p").append(`${response.show.n_ospiti} ospiti &#8226; 3 stanze da letto`).addClass("text-muted");
            // -- Map
            $("#map > iframe").attr("src", `https://www.google.com/maps/embed/v1/place?key=AIzaSyDS70zwyWHYnuia677DVOj8CRqfAzI00Qo
                &q=${response.show.citta}`);
          })
          .catch((err) => console.log(err));

        
      });
    </script>
      
    </script>
  </body>
</html>

<!-- <form action="">
  <label class="mandatory" for="region">Regione *</label>
  <select id="region" name="region" required>
    <option data-tassa="1" value="-1" selected></option>
    <option data-tassa="10" value="0">Abruzzo</option>
    <option data-tassa="9" value="1">Basilicata</option>
    <option data-tassa="10" value="2">Calabria</option>
    <option data-tassa="10" value="3">Campania</option>
    <option data-tassa="10" value="4">Emilia-Romagna</option>
    <option data-tassa="10" value="5">Friuli-Venezia Giulia</option>
    <option data-tassa="10" value="6">Lazio</option>
    <option data-tassa="10" value="7">Liguria</option>
    <option data-tassa="10" value="8">Lombardia</option>
    <option data-tassa="10" value="9">Marche</option>
    <option data-tassa="10" value="10">Molise</option>
    <option data-tassa="10" value="11">Piemonte</option>
    <option data-tassa="10" value="12">Puglia</option>
    <option data-tassa="10" value="13">Sardegna</option>
    <option data-tassa="10" value="14">Sicilia</option>
    <option data-tassa="10" value="15">Toscana</option>
    <option data-tassa="10" value="16">Trentino-Alto Adige</option>
    <option data-tassa="10" value="17">Umbria</option>
    <option data-tassa="10" value="18">Valle d'Aosta</option>
    <option data-tassa="10" value="19">Veneto</option>
  </select>
</form> -->

<!-- $("select").on("change", () => { $("body").append( `
<div>${$("select option:selected").data("tassa")}</div>
` ); }); -->
